<div class="insert-page">
  <div class="insert-container">
    <div class="card glass">
      <h2>Yeni Fatura Olu≈ütur</h2>
      
      <div class="invoice-header grid-2">
        <div class="form-group">
          <label>Fatura Numarasƒ±</label>
          <input type="text" [(ngModel)]="invoice.InvoiceNumber" placeholder="√ñrn: INV-2026-001">
        </div>
        <div class="form-group">
          <label>M√º≈üteri ID</label>
          <input type="number" [(ngModel)]="invoice.CustomerId">
          <small *ngIf="(invoice.CustomerId || 0) <= 0" style="color: #ff4d4d; font-size: 11px;">
            * Ge√ßerli bir M√º≈üteri ID giriniz.
          </small>
        </div>
        <div class="form-group">
          <label>Fatura Tarihi</label>
          <input type="date" [(ngModel)]="invoice.InvoiceDate">
        </div>
        <div class="form-group">
          <label>Genel Toplam</label>
          <input type="text" [value]="invoice.TotalAmount | currency:'TRY'" disabled class="total-input">
        </div>
      </div>

      <hr class="divider">

    <h3>Fatura Kalemleri</h3>
    <div class="line-entry-form grid-4">
      <div class="form-group">
        <label>√úr√ºn/Hizmet Adƒ±</label>
        <input type="text" [(ngModel)]="newLine.ItemName" placeholder="√ñrn: Yazƒ±lƒ±m Hizmeti">
      </div>

      <div class="form-group">
        <label>Adet</label>
        <input type="number" [(ngModel)]="newLine.Quentity" placeholder="0">
      </div>

      <div class="form-group">
        <label>Birim Fiyat</label>
        <input type="number" [(ngModel)]="newLine.Price" placeholder="0.00">
      </div>

      <div class="form-group">
        <label>&nbsp;</label> 
        <button class="add-line-btn" 
                (click)="addLine()" 
                [disabled]="!newLine.ItemName || !newLine.Quentity || !newLine.Price">
          Ekle
        </button>
      </div>
    </div>

      <div class="lines-table-wrapper">
        <table class="lines-table">
          <thead>
            <tr>
              <th>√úr√ºn</th>
              <th>Adet</th>
              <th>Birim Fiyat</th>
              <th>Toplam</th>
              <th>ƒ∞≈ülem</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let line of invoice.Lines; let i = index">
              <td>{{ line.ItemName }}</td>
              <td>{{ line.Quentity }}</td>
              <td>{{ line.Price | currency:'TRY' }}</td>
              <td>{{ (line.Quentity * line.Price) | currency:'TRY' }}</td>
              <td><button class="btn-delete" (click)="removeLine(i)">üóëÔ∏è</button></td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="actions">
        <button type="button" class="cancel-btn" routerLink="/invoice-list">ƒ∞ptal</button>
        
        <button class="save-btn" 
                (click)="onSave()" 
                [disabled]="!invoice.InvoiceNumber || invoice.InvoiceNumber.trim() === '' || (invoice.CustomerId || 0) <= 0">
          Faturayƒ± Kaydet
        </button>
      </div>
    </div>
  </div>
</div>